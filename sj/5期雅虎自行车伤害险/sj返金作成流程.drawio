<mxfile host="drawio-plugin" modified="2022-12-27T06:18:35.757Z" agent="5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36" etag="0FcitfY-eaYjG75JhNlk" version="20.5.3" type="embed"><diagram name="Page-1" id="c7558073-3199-34d8-9f00-42111426c3f3"><mxGraphModel dx="1139" dy="1891" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" background="none" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><UserObject label="bcp" id="98"><mxCell style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontFamily=Lucida Console;verticalAlign=middle;align=left;" parent="1" vertex="1"><mxGeometry x="20" y="762" width="2740" height="1488" as="geometry"/></mxCell></UserObject><mxCell id="237" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="98" source="256" target="408" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="1346.1" y="493" as="sourcePoint"/><mxPoint x="1346" y="540.9999999999995" as="targetPoint"/></mxGeometry></mxCell><mxCell id="432" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="248" target="253" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="248" value="返金数据汇总" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1371" y="159.57999999999998" width="139" height="62" as="geometry"/></mxCell><mxCell id="221" value="&lt;font color=&quot;#323232&quot;&gt;&lt;span style=&quot;font-size: 18px; background-color: rgba(255, 255, 255, 0.01);&quot;&gt;雅虎返金文件作成&lt;/span&gt;&lt;/font&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="106.5" y="149.07999999999998" width="87" height="81" as="geometry"/></mxCell><mxCell id="223" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="98" source="221" target="270" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="303" y="142" as="targetPoint"/></mxGeometry></mxCell><mxCell id="433" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="253" target="254" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="253" value="作成tsv文件上传Graphene-S3" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1584.07" y="159.58" width="139" height="62" as="geometry"/></mxCell><mxCell id="438" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="254" target="437" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="254" value="经过GPG格式加密并作成tsv文件上传Yahoo-文件服务器" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1802.5" y="152.35" width="155.5" height="76.43" as="geometry"/></mxCell><mxCell id="448" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0;entryDx=330;entryDy=126;entryPerimeter=0;fontFamily=Lucida Console;fontSize=14;dashed=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="98" source="256" target="447" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="256" value="&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;bill&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1295.0700000000002" y="451" width="101.87" height="32" as="geometry"/></mxCell><mxCell id="443" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;dashed=1;" parent="98" source="270" target="442" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="270" value="&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;setBillConfirmDateStart([bizTime-2月]的所属月份的1号0点0分)&lt;br&gt;setBillConfirmDateEnd([bizTime-1月]的所属月份月末23点59分)&lt;br&gt;setTransType(POS_BIG_POSONLINE(19, &quot;大保全(保全)&quot;))&lt;div style=&quot;font-size: 16px;&quot;&gt;setBillStatus(CONFIRMED(2, &quot;已确认&quot;))&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;setArAp(Ap(2, &quot;应付&quot;))&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;setArapAccountType(YAHOO_WALLET_SJ(135,&lt;br&gt;&quot;ウォレット / Yahoo&quot;))&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;text-align: center; font-size: 16px;&quot;&gt;以上作为条件查询&lt;/div&gt;&lt;div style=&quot;text-align: center; font-size: 16px;&quot;&gt;bill&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;align=left;fontSize=16;" parent="98" vertex="1"><mxGeometry x="300" y="69.16" width="400" height="240.84" as="geometry"/></mxCell><mxCell id="272" value="&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;每页最大的ID，以每页limit1000为基准，分页查询，按id正序排序，取每页最后一条记录更新maxIdValue，作为下一个分页查询的条件&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="806" y="134.94999999999993" width="230" height="109.25" as="geometry"/></mxCell><mxCell id="269" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="98" source="270" target="272" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="431" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="273" target="248" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="273" value="&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;查询获取到list&lt;div style=&quot;font-size: 16px;&quot;&gt;遍历，异步处理每个object&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1144" y="145.56999999999994" width="150" height="90" as="geometry"/></mxCell><mxCell id="271" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="98" source="272" target="273" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="446" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="407" target="412" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="407" value="通过被保人partyId查询customer服务得到channelUserNo" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1262.25" y="828" width="167.5" height="82" as="geometry"/></mxCell><mxCell id="405" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=13;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="98" source="428" target="407" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="1346" y="770" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="411" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Lucida Console;fontSize=16;dashed=1;" parent="98" source="408" target="410" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="445" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="408" target="428" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="408" value="查询bill详情&lt;br&gt;queryBcpBillHandler#operate" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1281" y="568" width="130" height="62" as="geometry"/></mxCell><mxCell id="410" value="bill&lt;br&gt;receivable_payable&lt;br&gt;bcp_ext_info" style="shape=note;size=0;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1595" y="548" width="200" height="102" as="geometry"/></mxCell><mxCell id="415" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="412" target="414" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="412" value="组装返金数据" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1268.5" y="992" width="155" height="52" as="geometry"/></mxCell><mxCell id="436" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Lucida Console;fontSize=16;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="98" source="414" target="434" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="414" value="插入到bcp的课金返金表（新增表）" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1281" y="1122" width="130" height="62" as="geometry"/></mxCell><mxCell id="428" value="查询保单详情" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1283.5" y="708" width="125" height="42" as="geometry"/></mxCell><mxCell id="434" value="&lt;font color=&quot;#323232&quot;&gt;&lt;span style=&quot;background-color: rgba(255, 255, 255, 0.01);&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;stop&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1302.5" y="1268" width="87" height="81" as="geometry"/></mxCell><mxCell id="437" value="&lt;font color=&quot;#323232&quot;&gt;&lt;span style=&quot;background-color: rgba(255, 255, 255, 0.01);&quot;&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;stop&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;/font&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="2033" y="150.08" width="87" height="81" as="geometry"/></mxCell><mxCell id="442" value="&lt;div&gt;SELECT&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;*&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;bill&amp;nbsp;&lt;/div&gt;&lt;div&gt;WHERE&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;bill_confirm_date &amp;gt;= '2022-10-01 00:00:00'&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND bill_confirm_date &amp;lt;= '2022-11-30 23:59:59'&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND TRANS_TYPE IN ( 19 )&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND bill_status = 2&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND AR_AP = 2&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND arap_account_type = 135&lt;br&gt;AND id &amp;gt; 222&lt;br&gt;limit 1000&lt;/div&gt;" style="shape=note;size=20;whiteSpace=wrap;html=1;align=left;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="270" y="378" width="460" height="252" as="geometry"/></mxCell><mxCell id="444" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;fontFamily=Lucida Console;fontSize=16;" parent="98" source="408" target="408" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="447" value="&lt;div style=&quot;font-size: 16px;&quot;&gt;①当送金数据的作成年月≠保険始期日的年月时&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;送金数据の作成年月（解約或取消的処理年月）＝返金文件的作成年月的前月&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;&lt;br style=&quot;font-size: 16px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;②当送金数据的作成年月＝保険始期日的年月时&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;font-size: 16px;&quot;&gt;送金数据的作成年月（解約或取消的処理年月）＝返金文件的作成年月的前2个月&amp;nbsp;&lt;/div&gt;" style="shape=note;size=20;whiteSpace=wrap;html=1;align=left;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="840" y="398" width="330" height="232" as="geometry"/></mxCell><mxCell id="220" value="customer" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontSize=16;" parent="1" vertex="1"><mxGeometry x="20" y="477" width="2730" height="229" as="geometry"/></mxCell><mxCell id="404" value="/customer&lt;br style=&quot;font-size: 16px;&quot;&gt;/queryCustomerPage" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="220" vertex="1"><mxGeometry x="2210" y="70" width="120" height="60" as="geometry"/></mxCell><mxCell id="417" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;dashed=1;" parent="1" source="407" target="404" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="425" value="policy" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontSize=16;" parent="1" vertex="1"><mxGeometry x="20" y="181" width="2730" height="249" as="geometry"/></mxCell><mxCell id="426" value="/policy&lt;br&gt;/queryPolicyByCondition" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="425" vertex="1"><mxGeometry x="2090" y="80" width="120" height="60" as="geometry"/></mxCell><mxCell id="427" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=Lucida Console;fontSize=16;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="428" target="426" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="1965" y="1691" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="439" value="foundation" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontSize=16;" parent="1" vertex="1"><mxGeometry x="20" y="-104" width="2730" height="230" as="geometry"/></mxCell><mxCell id="440" value="/file&lt;br&gt;/operate" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="439" vertex="1"><mxGeometry x="1593.57" y="60" width="120" height="60" as="geometry"/></mxCell><mxCell id="441" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Lucida Console;fontSize=16;dashed=1;" parent="1" source="253" target="440" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>