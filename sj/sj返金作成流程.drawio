<mxfile host="drawio-plugin" modified="2022-12-16T08:13:51.824Z" agent="5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36" etag="7H8u57YQb-l0Exb9SM0a" version="20.5.3" type="embed"><diagram name="Page-1" id="c7558073-3199-34d8-9f00-42111426c3f3"><mxGraphModel dx="797" dy="823" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" background="none" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><UserObject label="PolicyBatch" id="98"><mxCell style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontFamily=Lucida Console;verticalAlign=middle;" parent="1" vertex="1"><mxGeometry x="20" y="762" width="3960" height="3428" as="geometry"/></mxCell></UserObject><mxCell id="226" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="98" source="222" target="225" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="222" value="&lt;div class=&quot;mind-clipboard&quot;&gt;setRenewDueDate(bizTime)&lt;div&gt;setPremStatus(NORMAL_PAYMENT(1, &quot;正常缴费&quot;),STOP_PAYMENT(2, &quot;停止缴费&quot;))&lt;br&gt;&lt;/div&gt;&lt;div&gt;setRenewStatus(EFFECTIVE(1, &quot;生效中&quot;))&lt;br&gt;&lt;/div&gt;&lt;div&gt;以上作为条件查询&lt;/div&gt;&lt;div&gt;renew_policy_premium_schedule&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="303" y="85" width="280" height="114" as="geometry"/></mxCell><mxCell id="224" value="&lt;span style=&quot;color: rgb(16, 18, 20); font-family: &amp;quot;PingFang SC&amp;quot;, &amp;quot;Segoe UI&amp;quot;, Arial, &amp;quot;Microsoft YaHei&amp;quot;, 微软雅黑, 宋体, &amp;quot;Malgun Gothic&amp;quot;, sans-serif; font-size: 14px; text-align: start; background-color: rgb(255, 255, 255);&quot;&gt;每月1日0点提取包月计费保单&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="98" vertex="1"><mxGeometry x="90" y="56" width="120" height="30" as="geometry"/></mxCell><mxCell id="228" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="98" source="225" target="227" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="225" value="&lt;div class=&quot;mind-clipboard&quot;&gt;&lt;div class=&quot;mind-clipboard&quot;&gt;每页最大的ID，以每页limit1000为基准，分页查询，按id正序排序，取每页最后一条记录更新maxIdValue，作为下一个分页查询的条件&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="660" y="100.75" width="210" height="82.5" as="geometry"/></mxCell><mxCell id="227" value="&lt;div class=&quot;mind-clipboard&quot; style=&quot;font-size: 16px;&quot;&gt;查询获取到list&lt;div style=&quot;font-size: 16px;&quot;&gt;遍历，异步处理每个object&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="960" y="97" width="150" height="90" as="geometry"/></mxCell><mxCell id="237" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="98" source="234" target="238" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="1421" y="388" as="targetPoint"/></mxGeometry></mxCell><mxCell id="234" value="查询payment，对符合抽取条件的payment进行处理" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1334.1200000000001" y="278" width="173.75" height="82" as="geometry"/></mxCell><mxCell id="252" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="98" source="238" target="248"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="238" value="返金文件做成" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Lucida Console;fontSize=16;" parent="98" vertex="1"><mxGeometry x="1361" y="458" width="120" height="60" as="geometry"/></mxCell><mxCell id="254" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="98" source="248" target="253"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="248" value="作成文件上传Graphene-S3" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="1351.5" y="615" width="139" height="62" as="geometry"/></mxCell><mxCell id="221" value="&lt;font color=&quot;#323232&quot;&gt;&lt;span style=&quot;font-size: 18px; background-color: rgba(255, 255, 255, 0.01);&quot;&gt;雅虎课金文件作成&lt;/span&gt;&lt;/font&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;fontFamily=Lucida Console;" parent="98" vertex="1"><mxGeometry x="106.5" y="100.75" width="87" height="81" as="geometry"/></mxCell><mxCell id="223" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="98" source="221" target="222" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="251" value="&lt;div&gt;SELECT&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;*&amp;nbsp;&lt;/div&gt;&lt;div&gt;FROM&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;sj_gr_policy_batch.renew_policy_premium_schedule&amp;nbsp;&lt;/div&gt;&lt;div&gt;WHERE&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;is_deleted = 'N'&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND prem_status in (1,2)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND renew_status = 1&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;AND renew_due_date &amp;lt;= '2023-01-01 00:00:00'&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;&quot;&gt;&#9;&lt;/span&gt;LIMIT 1000&lt;/div&gt;" style="shape=note;size=20;whiteSpace=wrap;html=1;align=left;verticalAlign=middle;" parent="98" vertex="1"><mxGeometry x="280" y="288" width="290" height="160" as="geometry"/></mxCell><mxCell id="253" value="作成文件加密上传Yahoo-文件服务器" style="rounded=1;whiteSpace=wrap;html=1;fontSize=16;fontFamily=Lucida Console;" vertex="1" parent="98"><mxGeometry x="1346.75" y="768" width="148.5" height="62" as="geometry"/></mxCell><mxCell id="220" value="foundation" style="swimlane;horizontal=0;whiteSpace=wrap;html=1;fontSize=16;" parent="1" vertex="1"><mxGeometry x="20" y="440" width="3960" height="270" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>